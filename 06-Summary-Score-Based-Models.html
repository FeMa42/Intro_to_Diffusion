

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Summary: Score-Based Models &#8212; Introduction to Diffusion Models</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '06-Summary-Score-Based-Models';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Example: Score-Based Generative Model for 2D Swiss Roll Dataset" href="05-Score-SwissRoll-Example.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/forward_diffusion.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/forward_diffusion.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction to Diffusion and Score-Based Generative Models
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01-Generative-models.html">Generative Models</a></li>

<li class="toctree-l1"><a class="reference internal" href="02-Diffusion-Process.html">Illustration of Diffusion Process</a></li>

<li class="toctree-l1"><a class="reference internal" href="03-Continous-Diffusion-Process.html">Introduction: From Discrete Diffusion to Continous Time Diffusion Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-Score-Matching.html">Score Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-Score-SwissRoll-Example.html">Example: Score-Based Generative Model for 2D Swiss Roll Dataset</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">Summary: Score-Based Models</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FeMa42/Intro_to_Diffusion" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FeMa42/Intro_to_Diffusion/issues/new?title=Issue%20on%20page%20%2F06-Summary-Score-Based-Models.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/06-Summary-Score-Based-Models.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Summary: Score-Based Models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-continuous-time-diffusion-models-aka-score-based-models">Why Continuous-Time Diffusion Models aka Score based Models?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-view-on-score-based-models">Another view on Score-Based Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langevin-dynamics">Langevin Dynamics</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="summary-score-based-models">
<h1>Summary: Score-Based Models<a class="headerlink" href="#summary-score-based-models" title="Permalink to this heading">#</a></h1>
<p>… some text …</p>
<section id="why-continuous-time-diffusion-models-aka-score-based-models">
<h2>Why Continuous-Time Diffusion Models aka Score based Models?<a class="headerlink" href="#why-continuous-time-diffusion-models-aka-score-based-models" title="Permalink to this heading">#</a></h2>
<p>Despite differences, discrete-time and continuous-time models follow nearly identical generative processes. Continuous models are even more straightforward to handle:</p>
<ol class="arabic simple">
<li><p>They are versatile and can be transformed to discrete models through time discretization.</p></li>
<li><p>Their behavior can be described by well-studied SDEs.</p></li>
<li><p>They use standard numerical SDE solvers.</p></li>
<li><p>They can be converted to simple ordinary differential equations (ODEs).</p></li>
</ol>
<p>As noted, diffusion models generate samples by reversing the diffusion process that maps a Gaussian base distribution to complex data. This mapping, in continuous-time diffusion models represented by the generative SDE, is often complex due to the neural network approximating the score function <span class="math notranslate nohighlight">\(\nabla_{x_{t}}\log p_{t}(x_{t})\)</span>. Solving it with numerical integration techniques can require 1000s of calls to deep neural networks for sample generation. Consequently, these models are slower than alternatives like generative adversarial networks (GANs), which only require a single network call.</p>
</section>
<section id="another-view-on-score-based-models">
<h2>Another view on Score-Based Models<a class="headerlink" href="#another-view-on-score-based-models" title="Permalink to this heading">#</a></h2>
<p>Introduced by Song et al. in “Noise-Conditioned Score Network” (2019 <a class="reference external" href="https://arxiv.org/abs/1907.05600">https://arxiv.org/abs/1907.05600</a>) score-based models where motivated by the idea of using the score function <span class="math notranslate nohighlight">\(\nabla_x \log p(x)\)</span> to draw samples from a distribution <span class="math notranslate nohighlight">\(p(x)\)</span> using langevin dynamics avoiding the need to compute the normalizing constant <span class="math notranslate nohighlight">\(Z_\theta\)</span>. This idea is shortly explained here.</p>
<p>For a given dataset <span class="math notranslate nohighlight">\(\{x_1, x_2, ... x_N\}\)</span> with the underlying data distribution <span class="math notranslate nohighlight">\(p(x)\)</span> (each point is independently drawn), a generative model is fitted to this data distribution in order to synthesize new samples at will by sampling from the distribution. In likelihood based models we represent the probability distribution as probability density function (p.d.f.):</p>
<div class="math notranslate nohighlight">
\[
p_{\theta}(x)=\frac{e^{-f_{\theta}(x)}}{Z_{\theta}}
\]</div>
<p>where <span class="math notranslate nohighlight">\(f_{\theta}(x) \in \mathbb{R}\)</span> is a real valued function parameterized by learnable parameter <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(Z_{\theta}\)</span> is a normalizing constant dependant on <span class="math notranslate nohighlight">\(\theta\)</span>, such that <span class="math notranslate nohighlight">\(\int p_{\theta}(x)dx=1\)</span>. The function <span class="math notranslate nohighlight">\(f_{\theta}(x) \in \mathbb{R}\)</span> is often called an unnormalized probabilistic model or energy based model. We can learn <span class="math notranslate nohighlight">\(p_{\theta}(x)\)</span> by maximizing the log-likelihood of the data</p>
<div class="math notranslate nohighlight">
\[
\max_{\theta}\sum_{i=1}^{N}\log p_{\theta}(x).
\]</div>
<p>The energy function <span class="math notranslate nohighlight">\(f_{\theta}(x)\)</span> is typically parameterized by a flexible neural network. When training it as a likelihood model, we need to know the normalizing constant <span class="math notranslate nohighlight">\(Z_\theta\)</span> by computing complex high-dimensional integrals, which is typically intractable. To make this normalizing constant tractable we can restrict the model architecture (like in normalizing flows using invertible neural network models) or approximate this constant (for example in variational autoencoders).</p>
<p>Alternatively we can model the score function to avoid the difficulty of the intractable normalizing constant. Given a probablity density function <span class="math notranslate nohighlight">\(p(\mathbf{x})\)</span>, we define the score as</p>
<div class="math notranslate nohighlight">
\[
\nabla_\mathbf{x} \log p(\mathbf{x}).
\]</div>
<p>In constrast to the other models, when computing the score, we obtain <span class="math notranslate nohighlight">\(\nabla_\mathbf{x} \log p_\theta(\mathbf{x}) = -\nabla_\mathbf{x} f_\theta(\mathbf{x})\)</span> (since the log derivative of <span class="math notranslate nohighlight">\(Z_\theta\)</span> is zero) which does not require computing the normalizing constant <span class="math notranslate nohighlight">\(Z_\theta\)</span>. A <strong>score-based model</strong> <span class="math notranslate nohighlight">\(s_{\theta}(x)\approx \nabla_\mathbf{x} \log p(\mathbf{x})\)</span> is learned to approximate the score function. The score-based model is independant of the normalizing constant. As a result any neural network that maps an input vector <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^d\)</span> to an output vector <span class="math notranslate nohighlight">\(\mathbf{y} \in \mathbb{R}^d\)</span> can be used as a score-based model, as long as the output and input have the same dimensionality. This yields huge flexibility in choosing model architectures. We can estimate the score using the Fischer-divergence, which is defined as</p>
<div class="math notranslate nohighlight">
\[
\mathbb{E}_{p(x)}[||\nabla_x \log p(x)-s_{\theta}(x)||_2^2].
\]</div>
<p>There are several methods called score matching, which minimize the Fischer-divergence without knowledge of the underlying data distribution just using data samples (like <a class="reference external" href="https://arxiv.org/pdf/1905.07088.pdf">https://arxiv.org/pdf/1905.07088.pdf</a>).</p>
</section>
<section id="langevin-dynamics">
<h2>Langevin Dynamics<a class="headerlink" href="#langevin-dynamics" title="Permalink to this heading">#</a></h2>
<p>To draw samples from a trained score-based model <span class="math notranslate nohighlight">\(s_{\theta}(x)\approx \nabla_\mathbf{x} \log p(\mathbf{x})\)</span> we can use langevin dynamics.</p>
<p>Langevin dynamics provida a way to draw samples from a dystribution <span class="math notranslate nohighlight">\(p(x)\)</span> using is score function <span class="math notranslate nohighlight">\(\nabla_x \log p(x)\)</span> using a Marcov Chain Monte Carlo procedure. Using an arbitrary prior <span class="math notranslate nohighlight">\(x_0 \sim \pi(x)\)</span>, we can iterate with the following</p>
<div class="math notranslate nohighlight">
\[
x_{i+1}\leftarrow x_i + \epsilon \nabla_x\log p(x)+\sqrt{2\epsilon z_i}, i=0,1,..., K, 
\]</div>
<p>where <span class="math notranslate nohighlight">\(z_i\sim N(0,I)\)</span>. For <span class="math notranslate nohighlight">\(\epsilon \rightarrow 0\)</span> and <span class="math notranslate nohighlight">\(K \rightarrow \infty\)</span>, the obtained <span class="math notranslate nohighlight">\(x_K\)</span> converges to a sample fro <span class="math notranslate nohighlight">\(p(x)\)</span> under sime regularity conditions.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="05-Score-SwissRoll-Example.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Example: Score-Based Generative Model for 2D Swiss Roll Dataset</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-continuous-time-diffusion-models-aka-score-based-models">Why Continuous-Time Diffusion Models aka Score based Models?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-view-on-score-based-models">Another view on Score-Based Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langevin-dynamics">Langevin Dynamics</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Damian Boborzi
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>